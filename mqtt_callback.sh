#!/bin/bash
MYIFS=$IFS
IFS="
"


#####################################################################
####								#####
#### SETTINGS							#####
####	source settings.cfg					#####
####								#####
#####################################################################
source "$(dirname "$(readlink -f "$0")")""/settings.cfg"
#####################################################################
####								#####
#### FUNCTIONS							#####
####	include functions.def					#####
####								#####
#####################################################################
source "$(dirname "$(readlink -f "$0")")""/functions.def"
#####################################################################
#####################################################################

#####################################################################################################################################
########
########
#####################################################################################################################################
mosquitto_sub -R -h $_MQTTHOST -p $_MQTTPORT -u $_MQTTUSER -P $_MQTTPASS -q $_MQTTQOS -v -t "$MQTTCOMMANDTOPIC" | while read RAW_DATA
do
  echo "Got msg" 
 
	msg="rescan 1"
	if [ "$(echo "$RAW_DATA" | grep -i "$msg" | wc -l)" == "1" ]
	then
		echo "Forcing rescan"
		echo "1" > "$RESCANTRIGGER"
	fi
 		






done
#####################################################################################################################################
########
########
#####################################################################################################################################







